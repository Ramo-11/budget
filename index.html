<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Sahab Budget</title>
        <link rel="stylesheet" href="style.css" />
        <link rel="stylesheet" href="about.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    </head>
    <body>
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div
                    style="
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        width: 100%;
                    "
                >
                    <div>
                        <h1>Sahab Budget</h1>
                        <p
                            style="
                                font-size: 12px;
                                color: rgba(255, 255, 255, 0.7);
                                margin-top: 5px;
                            "
                        >
                            by
                            <a
                                href="https://sahab-solutions.com"
                                target="_blank"
                                style="color: var(--primary); text-decoration: none"
                                >Sahab Solutions</a
                            >
                        </p>
                    </div>
                    <div class="nav-buttons">
                        <button class="nav-btn active" onclick="switchView('dashboard')">
                            Dashboard
                        </button>
                        <button class="nav-btn" onclick="switchView('settings')">Settings</button>
                        <button class="nav-btn" onclick="switchView('about')">
                            About & Privacy
                        </button>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="upload-section">
                <div class="month-selector" id="monthSelector">
                    <label>Select Month:</label>
                    <select id="monthDropdown" onchange="switchToMonth(this.value)"></select>
                </div>

                <!-- Upload Section -->
                <div class="upload-section">
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap">
                        <div class="file-input-wrapper">
                            <input
                                type="file"
                                id="csvFile"
                                accept=".csv"
                                multiple
                                onchange="handleFileUpload(event)"
                            />
                            <span>Upload CSV Files</span>
                        </div>

                        <div class="month-selector" id="monthSelector">
                            <label>Select Month:</label>
                            <select
                                id="monthDropdown"
                                onchange="switchToMonth(this.value)"
                            ></select>
                        </div>

                        <!-- New Export/Analytics buttons -->
                        <div
                            class="action-buttons"
                            style="margin-left: auto; display: flex; gap: 10px"
                        >
                            <button class="btn btn-secondary" onclick="findAndMergeDuplicates()">
                                Remove Duplicates
                            </button>
                            <button class="btn btn-secondary" onclick="exportToCSV()">
                                Export CSV
                            </button>
                            <button class="btn btn-secondary" onclick="exportToJSON()">
                                Backup Data
                            </button>
                            <button
                                class="btn btn-primary"
                                onclick="window.location.href='analytics.html'"
                            >
                                View Analytics ‚Üí
                            </button>
                        </div>
                    </div>

                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <p>Processing your data...</p>
                    </div>
                </div>
            </div>

            <!-- Dashboard View -->
            <div class="view active" id="dashboardView">
                <div class="summary-cards" id="summaryCards"></div>
                <div class="charts-container">
                    <div class="chart-wrapper">
                        <h3>Expense Distribution</h3>
                        <canvas id="pieChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h3>Category Breakdown</h3>
                        <canvas id="barChart"></canvas>
                    </div>
                </div>
                <h3 style="margin: 20px 0 10px">Detailed Breakdown</h3>
                <div class="category-details" id="categoryDetails"></div>
            </div>

            <!-- Settings View -->
            <div class="view" id="settingsView">
                <h2>Settings</h2>

                <!-- Budget Goals Section -->
                <div class="settings-section">
                    <h3>Budget Goals</h3>
                    <div class="budget-grid" id="budgetGrid"></div>
                </div>

                <!-- Categories Section -->
                <div class="settings-section">
                    <h3>Categories</h3>
                    <div style="display: flex; gap: 10px; margin-bottom: 15px">
                        <button class="btn btn-primary" onclick="addNewCategory()">
                            Add Category
                        </button>
                        <button class="btn btn-primary" onclick="saveCategoryConfig()">
                            Save Changes
                        </button>
                        <button class="btn btn-secondary" onclick="recategorizeAll()">
                            Recategorize All
                        </button>
                    </div>
                    <div id="categoriesList" style="margin-top: 20px"></div>
                </div>

                <div class="settings-section">
                    <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
                </div>
            </div>
        </div>

        <!-- About View -->
        <div class="view" id="aboutView">
            <div class="about-container">
                <!-- Hero Section -->
                <div class="about-hero">
                    <h2>Your Financial Data is 100% Private</h2>
                    <p class="about-subtitle">
                        Sahab Budget runs entirely in your browser. Your data never leaves your
                        device.
                    </p>
                </div>

                <!-- Privacy Section -->
                <div class="about-section">
                    <h3>üîí Complete Privacy Guarantee</h3>
                    <div class="privacy-grid">
                        <div class="privacy-card">
                            <span class="privacy-icon">üíª</span>
                            <h4>100% Local</h4>
                            <p>
                                All processing happens in your browser. No servers, no cloud, no
                                external connections.
                            </p>
                        </div>
                        <div class="privacy-card">
                            <span class="privacy-icon">üîê</span>
                            <h4>Your Data Stays Yours</h4>
                            <p>
                                We cannot see, access, or retrieve your financial data - it's
                                technically impossible.
                            </p>
                        </div>
                        <div class="privacy-card">
                            <span class="privacy-icon">üö´</span>
                            <h4>No Analytics or Tracking</h4>
                            <p>
                                No Google Analytics, no cookies, no tracking pixels. Complete
                                privacy.
                            </p>
                        </div>
                        <div class="privacy-card">
                            <span class="privacy-icon">üì±</span>
                            <h4>Works Offline</h4>
                            <p>
                                Once loaded, the app works completely offline. No internet required.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- How It Works Section -->
                <div class="about-section">
                    <h3>üìä How to Use Sahab Budget</h3>
                    <div class="features-list">
                        <div class="feature-item">
                            <span class="feature-number">1</span>
                            <div>
                                <h4>Upload Your Bank CSV</h4>
                                <p>
                                    Export transactions from your bank as CSV and upload them.
                                    Multiple files supported.
                                </p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-number">2</span>
                            <div>
                                <h4>Automatic Categorization</h4>
                                <p>
                                    Transactions are automatically sorted into categories based on
                                    keywords.
                                </p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-number">3</span>
                            <div>
                                <h4>Drag & Drop to Reorganize</h4>
                                <p>
                                    Simply drag transactions between categories to recategorize
                                    them.
                                </p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-number">4</span>
                            <div>
                                <h4>Set Budget Goals</h4>
                                <p>
                                    Set monthly budgets for each category and track your progress.
                                </p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-number">5</span>
                            <div>
                                <h4>Visualize Your Spending</h4>
                                <p>
                                    See your expenses through interactive charts and detailed
                                    breakdowns.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Persistence Section -->
                <div class="about-section">
                    <h3>üíæ How Your Data is Stored</h3>
                    <div class="storage-info">
                        <p><strong>Your data is saved in your browser's localStorage:</strong></p>

                        <div class="storage-grid">
                            <div class="storage-card safe">
                                <h4>‚úÖ Data Persists When You:</h4>
                                <ul>
                                    <li>Close the tab</li>
                                    <li>Close the browser</li>
                                    <li>Restart your computer</li>
                                    <li>Come back days/weeks later</li>
                                </ul>
                            </div>
                            <div class="storage-card warning">
                                <h4>‚ö†Ô∏è Data is Lost When You:</h4>
                                <ul>
                                    <li>Clear browser data/cache</li>
                                    <li>Use Incognito/Private mode</li>
                                    <li>Click "Clear All Data" in settings</li>
                                    <li>Use privacy/cleaning tools</li>
                                </ul>
                            </div>
                        </div>

                        <div class="tip-box">
                            <strong>üí° Pro Tip:</strong> Use the same browser on the same device to
                            keep your data accessible.
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="about-footer">
                    <div class="about-credits">
                        <h4>Built with ‚ù§Ô∏è by Sahab Solutions</h4>
                        <p>Simple, private, and powerful budget tracking for everyone.</p>
                        <a
                            href="https://sahab-solutions.com"
                            target="_blank"
                            class="btn btn-primary"
                        >
                            Visit Sahab Solutions
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transactions Modal -->
        <div class="modal" id="transactionsModal">
            <div class="modal-content" style="width: 800px">
                <div class="modal-header">
                    <h2 id="modalTitle">Transactions</h2>
                    <button class="close-btn" onclick="closeModal('transactionsModal')">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="transactions-list" id="transactionsList"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('transactionsModal')">
                        Close
                    </button>
                </div>
            </div>
        </div>
        <script src="utils.js"></script>
        <script src="script.js"></script>
    </body>
</html>
